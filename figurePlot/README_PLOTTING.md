# Justitia å®éªŒæ•°æ®åˆ†æä¸ç»˜å›¾æŒ‡å—

æœ¬ç›®å½•åŒ…å«ç”¨äºåˆ†æ Justitia æ¿€åŠ±æœºåˆ¶å®éªŒæ•°æ®å¹¶ç”Ÿæˆè®ºæ–‡å›¾è¡¨çš„å®Œæ•´å·¥å…·é“¾ã€‚

## ğŸ“‹ ç›®å½•ç»“æ„

```
figurePlot/
â”œâ”€â”€ justitia_data_analyzer.py   # æ•°æ®åˆ†æå™¨ï¼ˆç¬¬ä¸€æ­¥ï¼‰
â”œâ”€â”€ justitia_plot_all.py        # ç»˜å›¾ç¨‹åºï¼ˆç¬¬äºŒæ­¥ï¼‰
â”œâ”€â”€ run_analysis.bat            # Windowsæ‰¹å¤„ç†è„šæœ¬
â”œâ”€â”€ run_analysis.sh             # Linux/Macè„šæœ¬
â”œâ”€â”€ data/                       # åˆ†æåçš„æ•°æ®ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â””â”€â”€ figures/                    # ç”Ÿæˆçš„å›¾è¡¨ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ­¥éª¤1: è¿è¡Œå®éªŒæ”¶é›†æ•°æ®

éœ€è¦è¿è¡Œ **5 æ¬¡å®éªŒ**ï¼Œæ¯æ¬¡ä½¿ç”¨ä¸åŒçš„è¡¥è´´æœºåˆ¶é…ç½®ï¼š

#### å®éªŒ1: Monoxideï¼ˆæ— Justitiaï¼‰
```json
{
  "EnableJustitia": 0
}
```
è¿è¡Œåå°† `expTest/` é‡å‘½åä¸º `expTest_monoxide/`

#### å®éªŒ2: R=0ï¼ˆæ— è¡¥è´´ï¼‰
```json
{
  "EnableJustitia": 1,
  "JustitiaSubsidyMode": 0
}
```
è¿è¡Œåå°† `expTest/` é‡å‘½åä¸º `expTest_R0/`

#### å®éªŒ3: R=E(f_B)ï¼ˆæ¨èæ–¹æ¡ˆï¼‰
```json
{
  "EnableJustitia": 1,
  "JustitiaSubsidyMode": 1
}
```
è¿è¡Œåå°† `expTest/` é‡å‘½åä¸º `expTest_R_EB/`

#### å®éªŒ4: R=E(f_A)+E(f_B)
```json
{
  "EnableJustitia": 1,
  "JustitiaSubsidyMode": 2
}
```
è¿è¡Œåå°† `expTest/` é‡å‘½åä¸º `expTest_R_EA_EB/`

#### å®éªŒ5: R=1 ETH/CTXï¼ˆå›ºå®šè¡¥è´´ï¼‰
```json
{
  "EnableJustitia": 1,
  "JustitiaSubsidyMode": 4,
  "JustitiaRewardBase": 1000000000000000000
}
```
è¿è¡Œåå°† `expTest/` é‡å‘½åä¸º `expTest_R_1ETH/`

### æ­¥éª¤2: è¿è¡Œæ•°æ®åˆ†æ

ç¡®ä¿é¡¹ç›®æ ¹ç›®å½•ä¸‹æœ‰ä»¥ä¸‹æ–‡ä»¶å¤¹ï¼š
```
Justitia-/
â”œâ”€â”€ expTest_monoxide/result/
â”œâ”€â”€ expTest_R0/result/
â”œâ”€â”€ expTest_R_EB/result/
â”œâ”€â”€ expTest_R_EA_EB/result/
â””â”€â”€ expTest_R_1ETH/result/
```

è¿›å…¥ `figurePlot` ç›®å½•å¹¶è¿è¡Œåˆ†æå™¨ï¼š

```bash
cd figurePlot
python justitia_data_analyzer.py
```

è¿™å°†åœ¨ `data/` ç›®å½•ä¸‹ç”Ÿæˆæ‰€æœ‰ç»˜å›¾æ‰€éœ€çš„æ•°æ®æ–‡ä»¶ã€‚

### æ­¥éª¤3: ç”Ÿæˆå›¾è¡¨

```bash
python justitia_plot_all.py
```

è¿™å°†åœ¨ `figures/` ç›®å½•ä¸‹ç”Ÿæˆæ‰€æœ‰7å¼ å›¾è¡¨ã€‚

### ä¸€é”®è¿è¡Œï¼ˆæ¨èï¼‰

**Windows:**
```bash
run_analysis.bat
```

**Linux/Mac:**
```bash
chmod +x run_analysis.sh
./run_analysis.sh
```

## ğŸ“Š ç”Ÿæˆçš„å›¾è¡¨

### å›¾1: CTXæ’é˜Ÿå»¶è¿Ÿç®±çº¿å›¾
- **æ–‡ä»¶**: `fig1_ctx_latency_boxplot.png`
- **ç±»å‹**: ç®±çº¿å›¾ (Boxplot)
- **Xè½´**: 5ç§è¡¥è´´æœºåˆ¶
- **Yè½´**: æ’é˜Ÿå»¶è¿Ÿï¼ˆç§’ï¼‰
- **è¯´æ˜**: å±•ç¤ºä¸åŒæœºåˆ¶ä¸‹CTXå»¶è¿Ÿçš„åˆ†å¸ƒæƒ…å†µ

### å›¾2: CTX/ITXå»¶è¿Ÿæ¯”å€¼
- **æ–‡ä»¶**: `fig2_latency_ratio_bar.png`
- **ç±»å‹**: æŸ±çŠ¶å›¾ (Bar Chart)
- **Xè½´**: 5ç§è¡¥è´´æœºåˆ¶
- **Yè½´**: CTXå»¶è¿Ÿ Ã· ITXå»¶è¿Ÿ
- **è¯´æ˜**: æ¯”å€¼=1.0è¡¨ç¤ºå…¬å¹³ï¼Œ<1.0è¡¨ç¤ºCTXæ›´å¿«

### å›¾3: CTXå»¶è¿ŸKDEåˆ†å¸ƒ
- **æ–‡ä»¶**: `fig3_latency_kde.png`
- **ç±»å‹**: æ ¸å¯†åº¦ä¼°è®¡æ›²çº¿ (KDE)
- **Xè½´**: æ’é˜Ÿå»¶è¿Ÿï¼ˆ0-50ç§’ï¼‰
- **Yè½´**: æ¦‚ç‡å¯†åº¦
- **è¯´æ˜**: å¹³æ»‘æ›²çº¿æ˜¾ç¤ºå»¶è¿Ÿåˆ†å¸ƒ

### å›¾4: CTXå»¶è¿ŸCDF
- **æ–‡ä»¶**: `fig4_latency_cdf.png`
- **ç±»å‹**: ç´¯ç§¯åˆ†å¸ƒå‡½æ•° (CDF)
- **Xè½´**: æ’é˜Ÿå»¶è¿Ÿï¼ˆç§’ï¼‰
- **Yè½´**: ç´¯ç§¯æ¦‚ç‡ï¼ˆ0-1ï¼‰
- **è¯´æ˜**: æ˜¾ç¤ºå»¶è¿Ÿçš„ç´¯ç§¯åˆ†å¸ƒ

### å›¾5: åŒºå—ä¸­CTXå æ¯”
- **æ–‡ä»¶**: `fig5_ctx_ratio.png`
- **ç±»å‹**: æŸ±çŠ¶å›¾ (Bar Chart)
- **Xè½´**: 5ç§è¡¥è´´æœºåˆ¶
- **Yè½´**: CTXå æ¯”ï¼ˆ0-100%ï¼‰
- **è¯´æ˜**: æ˜¾ç¤ºCTXåœ¨æ‰“åŒ…äº¤æ˜“ä¸­çš„ä¼˜å…ˆçº§

### å›¾6: ç´¯è®¡è¡¥è´´å‘è¡Œé‡
- **æ–‡ä»¶**: `fig6_cumulative_subsidy.png`
- **ç±»å‹**: æŠ˜çº¿å›¾ï¼ˆå¯¹æ•°åæ ‡ï¼‰
- **Xè½´**: åŒºå—é«˜åº¦
- **Yè½´**: ç´¯è®¡è¡¥è´´ï¼ˆETHï¼Œå¯¹æ•°åˆ»åº¦ï¼‰
- **è¯´æ˜**: æ˜¾ç¤ºè¡¥è´´æˆæœ¬éšæ—¶é—´çš„å¢é•¿

### å›¾7: æè®®è€…åˆ©æ¶¦åˆ†å¸ƒ
- **æ–‡ä»¶**: `fig7_proposer_profit_cdf.png`
- **ç±»å‹**: CDFï¼ˆå¯¹æ•°åæ ‡ï¼‰
- **Xè½´**: å•ç¬”äº¤æ˜“åˆ©æ¶¦ï¼ˆETHï¼Œå¯¹æ•°åˆ»åº¦ï¼‰
- **Yè½´**: ç´¯ç§¯æ¦‚ç‡ï¼ˆ0-1ï¼‰
- **è¯´æ˜**: å¯¹æ¯”ITXå’ŒCTXçš„åˆ©æ¶¦åˆ†å¸ƒï¼ŒéªŒè¯å…¬å¹³æ€§

## ğŸ”§ ä¾èµ–å®‰è£…

```bash
pip install numpy pandas matplotlib seaborn scipy
```

æˆ–ä½¿ç”¨ requirements.txt:
```bash
pip install -r requirements.txt
```

## ğŸ“ æ•°æ®æ–‡ä»¶è¯´æ˜

### è¾“å…¥æ•°æ®ï¼ˆä»å®éªŒç”Ÿæˆï¼‰
æ¯ä¸ªå®éªŒæ–‡ä»¶å¤¹çš„ `result/` ç›®å½•åº”åŒ…å«ï¼š
- `Justitia_Effectiveness.csv` - ä¸»è¦æŒ‡æ ‡æ•°æ®
- `TxDetail.csv` - äº¤æ˜“è¯¦æƒ…ï¼ˆå¯é€‰ï¼‰
- `CTX_FeeLatency.csv` - CTXè´¹ç”¨å»¶è¿Ÿï¼ˆå¯é€‰ï¼‰

### ä¸­é—´æ•°æ®ï¼ˆåˆ†æå™¨ç”Ÿæˆï¼‰
`data/` ç›®å½•åŒ…å«ï¼š
- `fig1_queueing_latency_boxplot.json`
- `fig2_latency_ratio_bar.json`
- `fig3_kde_distribution.json`
- `fig4_cdf.json`
- `fig5_ctx_ratio.json`
- `fig6_cumulative_subsidy.json`
- `fig7_proposer_profit_cdf.json`
- `summary_report.json` - æ•°æ®æ‘˜è¦æŠ¥å‘Š

### è¾“å‡ºå›¾è¡¨
`figures/` ç›®å½•åŒ…å«æ‰€æœ‰ç”Ÿæˆçš„PNGå›¾è¡¨ã€‚

## ğŸ¨ è‡ªå®šä¹‰é…ç½®

### ä¿®æ”¹é¢œè‰²æ–¹æ¡ˆ
ç¼–è¾‘ `justitia_plot_all.py` ä¸­çš„ `COLORS` å­—å…¸ï¼š
```python
COLORS = {
    'Monoxide': '#E74C3C',      # çº¢è‰²
    'R=0': '#F39C12',           # æ©™è‰²
    'R=E(f_B)': '#27AE60',      # ç»¿è‰²
    'R=E(f_A)+E(f_B)': '#3498DB',  # è“è‰²
    'R=1 ETH/CTX': '#9B59B6'    # ç´«è‰²
}
```

### ä¿®æ”¹å›¾è¡¨å°ºå¯¸
ä¿®æ”¹ `figsize` å‚æ•°ï¼š
```python
fig, ax = plt.subplots(figsize=(10, 6))  # å®½10è‹±å¯¸ï¼Œé«˜6è‹±å¯¸
```

### ä¿®æ”¹DPIï¼ˆåˆ†è¾¨ç‡ï¼‰
ä¿®æ”¹å…¨å±€è®¾ç½®ï¼š
```python
plt.rcParams['figure.dpi'] = 300  # é»˜è®¤300 DPI
```

## ğŸ› æ•…éšœæ’é™¤

### é—®é¢˜1: æ‰¾ä¸åˆ°æ•°æ®æ–‡ä»¶
**é”™è¯¯**: `âš ï¸  è­¦å‘Š: æ–‡ä»¶å¤¹ä¸å­˜åœ¨`

**è§£å†³**:
- ç¡®è®¤å®éªŒæ–‡ä»¶å¤¹å‘½åæ­£ç¡®
- ç¡®è®¤ `result/` å­ç›®å½•å­˜åœ¨
- ç¡®è®¤ `Justitia_Effectiveness.csv` å­˜åœ¨

### é—®é¢˜2: æ•°æ®ä¸ºç©º
**é”™è¯¯**: `âš ï¸  æœªæ‰¾åˆ° Justitia_Effectiveness.csv`

**è§£å†³**:
- ç¡®è®¤å®éªŒè¿è¡Œå®Œæˆ
- ç¡®è®¤ `EnableJustitia=1` æ—¶æ‰ä¼šç”Ÿæˆæ­¤æ–‡ä»¶
- æ£€æŸ¥å®éªŒæ—¥å¿—æ˜¯å¦æœ‰é”™è¯¯

### é—®é¢˜3: ç»˜å›¾å¤±è´¥
**é”™è¯¯**: `æ— æ³•ä¸º XXX ç”ŸæˆKDE`

**è§£å†³**:
- æ•°æ®ç‚¹å¤ªå°‘ï¼ˆ<2ä¸ªï¼‰
- æ•°æ®å…¨éƒ¨ä¸º0æˆ–æ— æ•ˆ
- å¢åŠ å®éªŒè¿è¡Œæ—¶é—´ä»¥æ”¶é›†æ›´å¤šæ•°æ®

### é—®é¢˜4: ä¸­æ–‡æ˜¾ç¤ºä¹±ç 
**è§£å†³**:
- å®‰è£…ä¸­æ–‡å­—ä½“
- æˆ–ä¿®æ”¹ä»£ç ä½¿ç”¨è‹±æ–‡æ ‡ç­¾

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **å®éªŒæ—¶é•¿**: æ¯æ¬¡å®éªŒå»ºè®®è¿è¡Œè‡³å°‘100ä¸ªepochä»¥è·å¾—ç¨³å®šæ•°æ®
2. **æ•°æ®ä¸€è‡´æ€§**: 5æ¬¡å®éªŒåº”ä½¿ç”¨ç›¸åŒçš„å…¶ä»–å‚æ•°ï¼ˆé™¤è¡¥è´´é…ç½®å¤–ï¼‰
3. **æ–‡ä»¶å‘½å**: ä¸¥æ ¼æŒ‰ç…§æŒ‡å®šæ ¼å¼å‘½åå®éªŒæ–‡ä»¶å¤¹
4. **å†…å­˜ä½¿ç”¨**: å¤§è§„æ¨¡å®éªŒå¯èƒ½äº§ç”Ÿå¤§é‡æ•°æ®ï¼Œç¡®ä¿è¶³å¤Ÿç£ç›˜ç©ºé—´

## ğŸ“– å‚è€ƒæ–‡çŒ®

- **Justitia**: An Incentive Mechanism towards the Fairness of Cross-shard Transactions (INFOCOM 2025)
- **Monoxide**: Scale out blockchains with asynchronous consensus zones (NSDI 2019)

## ğŸ¤ è´¡çŒ®

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·æäº¤Issueæˆ–Pull Requestã€‚

---

**æœ€åæ›´æ–°**: 2025-11-17
**ç‰ˆæœ¬**: 1.0
